var comte=document.getElementById("comte"),circle=document.querySelector("a.btn-circle"),perso=document.getElementById("element"),para=document.querySelector(".paragraphe"),findepluie=!1;function recharger(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});window.location.href="./index.html?uuidv4="+e+"#presentationCartes"}function resetPers(e=""){console.log(`${e.length} == ${comte.innerHTML.length+1}`),e.length==comte.innerHTML.length+1&&(console.log("fin de l'histoire"),circle.style.cssText="transform: translateX(0vw) rotate(360deg); -webkit-transition: 1s 500ms;",para.style.overflowY="visible",localStorage.setItem("coucou","0"),findepluie=!0),perso.style.removeProperty("bottom"),perso.style.bottom="150px;",perso.style.removeProperty("right"),perso.style.removeProperty("left")}function sizeElements(e){var t=document.getElementsByClassName(e),r=new Array;for(let e=0;e<t.length;e++)r[e]=t[e].getBoundingClientRect();return r}function allInformationImg(e){var t=document.getElementsByClassName(e),r=new Array;for(let e=0;e<t.length;e++)r[e]=t[e].getAttribute("id");return r}function sizeElemt(e){return document.getElementById(e).getBoundingClientRect()}function takeInformation(e,t){for(let n=0;n<e.length;n++){var r=document.getElementById(e[n]).getBoundingClientRect();if(t.x>r.x&&t.x+t.width<r.x+r.width)return e[n]}}function isCollide(e,t){for(let n=0;n<t.length;n++){console.log(`img pos top/bottom:  ${t[n].y} , hauteur img: ${t[n].height}`),console.log(`img pos right/left:  ${t[n].x} , largeur img: ${t[n].width}`),console.log(`pers pos top/bottom:  ${e.y} , hauteur pers: ${e.height}`),console.log(`pers pos right/left:  ${e.x} , largeur pers: ${e.width}`);if(e.y+e.height+t[n].height-75<t[n].height)resetPers();else if(e.y-75>t[n].height)console.log("en dehors en bas");else if((e.x+e.height-75<t[n].x||e.x+e.width>t[n].x)&&(console.log(takeInformation(allInformationImg("img"),sizeElemt("element"))),console.log("coucou"),0==localStorage.getItem("coucou"))){localStorage.setItem("coucou","1");let e=takeInformation(allInformationImg("img"),sizeElemt("element"));if(suiteHistoire(e),console.log(typeof document.querySelector(`img#${e}`)),document.querySelector(`img#${e}`)){var r=document.querySelector(`img#${e}`).getAttribute("src");document.querySelector(".masthead").style.cssText=`background:url(${r}) no-repeat center/cover; background-position:bottom;`}}}}function rainFall(){const e=document.createElement("i");0==findepluie&&(e.classList.add("fas"),e.classList.add("fa-tint"),e.style.left=Math.random()*window.innerWidth+"px",e.style.animationDuration=2*Math.random()+"s",e.style.opacity=Math.random()+.4,e.style.fontSize=15*Math.random()+"px"),document.body.appendChild(e),setTimeout(()=>{e.remove()},1e3)}function getRandomInt(e){return Math.floor(Math.random()*e)}function genererHistoire(e){comte.innerHTML="",circle.style.cssText="transform: translateX(-100vw) rotate(360deg); -webkit-transition: 1s 500ms;";var t="";let r=new Array("loup","ours"),n=r[getRandomInt(r.length)],o=new Array("le pin's","le téléphone","le foulard","la basket"),a=o[getRandomInt(o.length)],i=new Array("droite","gauche"),l=i[getRandomInt(i.length)],s=new Array("affamée","saine et sauve"),u=s[getRandomInt(s.length)];var c="affamée"==u?" Le petit garçon sorta donc les cookies restants pour lui les donner.":"";switch(e){case"montagne":case"forêt":t+=`.<br><br>Le petit garçon courageux décida de se diriger vers la ${e}`;break;case"tempête":t+="malgré la tempête.";break;case"refuge":t+=`en direction du ${e} situé à la pointe de la montagne.`;break;default:resetPers()}switch(t+=`<br><br>Durant le périple le petit garçon rencontra un méchant ${n} qui avait faim. Fort heuresement, le petit garçon a sorti quelques cookies de son sac qu'il jeta en direction de l'animal affamé afin de se sauver discrétement des griffes de cette bête féroce.<br><br>C'est après de longues heures de marche que le petit garçon trouva un indice lui indiquant qu'il était sur le bon chemin. En effet, il trouva ${a} de Lyla au sol. Par conséquent, le petit garçon continua son chemin longuement, jusqu'à attérir à une intersection. Un à droite et un à gauche. Le petit garçon choisissa de faire confiance à son intution: il pris le chemin de ${l}.`,e){case"montagne":case"forêt":t+=`<br><br>Perséverant, il décida de continuer malgré la nuit et le froid tombant. C'est grâce à ses efforts qu'il retrouva la petite fille ${u} sous une cabane de fortune perdu dans la ${e}. ${c} Ils décidèrent tous les 2 de passer la nuit sur place, étant donné les vêtements chauds et le kit de survie que Lyla avait emporté.<br><br>C'est au levé du soleil, que les 2 petits aventuriers reprirent le chemin de la maison....`;break;case"tempête":t+=`<br><br>Le petit garçon décide de persister malgré l'arrivée de la tempête. C'est grâce à sa persévérance, que le petit garçon retrouvera la petite fille ${u} réfugiée dans une grotte. ${c} Ils décidèrent de dormir sur place au chaud, grâce au petit feu que Lyla avait fait à l'aide du kit de secours qu'elle avait emporté.<br><br>C'est au petit matin, vers 6h, que les 2 aventuriers reprirent le chemin de la maison....`;break;case"refuge":t+=`<br><br>Le petit téméraire décida de se mettre à l'abri pour la nuit dans le refuge il qu'il a vu. C'est au moment où il ouvra la porte qu'il retomba sur la pauvre petite fille ${u}. ${c}<br><br>C'est le lendemain que les 2 petits aventuriers retrouvèrent le chemin de leur domicile....`;break;default:resetPers()}var d,m,g=t,p=0;!function e(){if((m=g.slice(0,++p))!==g){comte.innerHTML=m;var r=m.split(" ");"tempête"==r[r.length-1]&&(findepluie=!1,setInterval(rainFall,.5)),comte.scrollIntoView({block:"end"});var n=m.slice(-1);if("<"===n&&(d=!0),">"===n&&(d=!1),d)return e();setTimeout(e,72),resetPers(t)}}()}function suiteHistoire(e){switch(e){case"carte1":genererHistoire("tempête");break;case"carte2":genererHistoire("montagne");break;case"carte3":genererHistoire("forêt");break;case"carte4":genererHistoire("refuge");break;default:recharger()}}function isCollide2(){perso.style.transition="all 100ms ease-in-out",isCollide(sizeElemt("element"),sizeElements("img"))}window.addEventListener("load",function(){localStorage.setItem("coucou","0"),window.addEventListener("keydown",function(e){switch(e.key){case"ArrowDown":perso.style.bottom=parseInt(perso.style.bottom||150)-10+"px",isCollide2();break;case"ArrowUp":perso.style.bottom=parseInt(perso.style.bottom||150)+10+"px",isCollide2();break;case"ArrowLeft":perso.style.left=parseInt(perso.style.left||0)-10+"px",isCollide2();break;case"ArrowRight":perso.style.left=parseInt(perso.style.left||0)+10+"px",isCollide2();break;case"Enter":case"Escape":break;default:return}e.preventDefault()},!0)});